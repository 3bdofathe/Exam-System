@if(showMessage){
<app-title [text]="'Student deleted successfully!'"></app-title>
} @if (isLoading) {
<app-loading />
} @else if (noStudentsFound && !isLoading) {
<app-not-found></app-not-found>
} @else{
<section class="container cont2 mx-auto">
  <div class="container mt-4">
    <div class="header">
      <h1 class="title">All Students</h1>
      <button class="add-btn" [routerLink]="['/students/edit/0']">
        ✨ Add New Student
      </button>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Levels</th>
            <th>Exams</th>
            <th>Degrees</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (student of students; track $index) {
          <tr>
            <td class="name-cell">{{ student.name }}</td>
            <td>
              <span
                class="level-badge"
                [ngClass]="getLevelClass(student.level)"
                >{{ student.level }}</span
              >
            </td>
            <td class="exams-cell">
              @if(student.attempts.length>0){ @for (attempt of
              student.attempts;let last = $last; track $index) {
              {{ attempt.exam?.subject }}
              @if (!last) {,} } } @else{
              <span class="ps-5" style="color: #f0a4a9">Not tested</span>
              }
            </td>
            <td class="degrees-cell">
              @if(student.attempts.length>0){ @for (attempt of
              student.attempts;let last = $last; track $index) {
              {{ attempt.percentage / 100 | percent : "1.2-2" }}
              <span> @if (!last) {,} </span>
              } } @else{
              <span class="ms-4" style="color: #f0a4a9">Nothing</span>
              }
            </td>
            <td class="actions-cell">
              <div class="action-buttons">
                <button
                  [routerLink]="['/students', student._id]"
                  class="btn btn-icon btn-blue"
                  title="view"
                >
                  <i class="bi bi-eye"></i>
                </button>
                <button
                  [routerLink]="['/students/edit', student._id]"
                  class="btn btn-icon btn-purple"
                  title="Edit"
                >
                  <i class="bi bi-pencil"></i>
                </button>
                <button
                  (click)="deleteStudent(student._id)"
                  class="btn btn-icon btn-red"
                  title="Delete"
                >
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>

  <!-- <button class="m-4 add-student">
        <i class="bi bi-plus fs-5 text-light"></i>
        <span class="ms-2" [routerLink]="['/students/edit/0']">Add new student</span>
    </button> -->

  <!-- pagination-->
  <nav class="d-flex justify-content-center my-4">
    <ul class="pagination gap-2">
      <!-- Previous -->
      <li class="page-item" [class.disabled]="currentPage === 1">
        <button
          class="page-link px-4 py-2"
          (click)="changePage(currentPage - 1)"
        >
          ← Prev
        </button>
      </li>

      <!-- Page Numbers -->
      @for (page of pagesArray; track $index){
      <li class="page-item" [class.active]="currentPage === page">
        <button
          class="page-link px-3 py-2"
          (click)="changePage(page)"
          [ngClass]="{
            'bg-primary text-white border-0 rounded-3': currentPage === page,
            'border rounded-3': currentPage !== page
          }"
        >
          {{ page }}
        </button>
      </li>
      }
      <!-- Next -->
      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <button
          class="page-link px-4 py-2"
          (click)="changePage(currentPage + 1)"
        >
          Next →
        </button>
      </li>
    </ul>
  </nav>
</section>
}
